<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>量子销售经理智能体 - Web演示</title>
    <!-- DeepSeek风格CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        .deepseek-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .message-bubble {
            max-width: 70%;
            word-wrap: break-word;
        }
        .streaming-dots span {
            animation: bounce 1.4s infinite ease-in-out both;
        }
        .streaming-dots span:nth-child(1) { animation-delay: -0.32s; }
        .streaming-dots span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
    </style>
</head>
<body class="text-white min-h-screen">
    <div id="app" class="flex flex-col h-screen">
        <!-- 顶部导航栏 -->
        <header class="bg-gray-800 border-b border-gray-700 px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-robot text-blue-400 text-xl"></i>
                        <h1 class="text-lg font-semibold">量子销售经理智能体</h1>
                    </div>
                    <div class="flex space-x-2">
                        <button class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-md text-sm transition-colors">
                            <i class="fas fa-cog mr-1"></i>配置
                        </button>
                        <button id="exportBtn" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded-md text-sm transition-colors">
                            <i class="fas fa-download mr-1"></i>导出对话
                        </button>
                    </div>
                </div>
                <div class="flex items-center space-x-2 text-sm text-gray-400">
                    <span>实时流式对话</span>
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                </div>
            </div>
        </header>

        <!-- 主内容区域 -->
        <main class="flex flex-1 overflow-hidden">
            <!-- 左侧边栏 -->
            <aside class="w-80 bg-gray-800 border-r border-gray-700 flex flex-col">
                <!-- 角色卡 -->
                <div class="p-4 border-b border-gray-700">
                    <div class="bg-gray-900 rounded-lg p-4">
                        <div class="flex items-center mb-3">
                            <img id="agentAvatar" src="https://picsum.photos/seed/quantum/60/60" alt="Agent Avatar" class="w-12 h-12 rounded-full mr-3">
                            <div>
                                <h3 id="agentName" class="font-semibold">量子销售经理</h3>
                                <p id="agentDesc" class="text-xs text-gray-400">加载中...</p>
                            </div>
                        </div>
                        <div class="space-y-2 text-xs">
                            <div><span class="text-gray-500">专业领域:</span> <span id="agentExpertise">量子计算, 企业销售</span></div>
                            <div><span class="text-gray-500">个性标签:</span> <span id="agentPersonality">专业, 友好, 分析型</span></div>
                        </div>
                    </div>
                </div>

                <!-- 工具选择 -->
                <div class="p-4 border-b border-gray-700">
                    <h3 class="text-sm font-medium mb-3">工具面板</h3>
                    <div class="space-y-2">
                        <div class="sidebar-item p-3 rounded-lg cursor-pointer transition-all">
                            <i class="fas fa-brain text-purple-400 mr-2"></i>
                            <span>推理框架</span>
                        </div>
                        <div class="sidebar-item p-3 rounded-lg cursor-pointer transition-all">
                            <i class="fas fa-search text-blue-400 mr-2"></i>
                            <span>知识检索</span>
                        </div>
                        <div class="sidebar-item p-3 rounded-lg cursor-pointer transition-all">
                            <i class="fas fa-shield-alt text-green-400 mr-2"></i>
                            <span>安全策略</span>
                        </div>
                    </div>
                </div>

                <!-- 历史记录 -->
                <div class="flex-1 overflow-y-auto p-4">
                    <h3 class="text-sm font-medium mb-3">对话历史</h3>
                    <div id="historyList" class="space-y-2">
                        <div class="p-3 bg-gray-900 rounded-lg">
                            <div class="text-sm">新对话</div>
                            <div class="text-xs text-gray-500 mt-1">点击开始新对话</div>
                        </div>
                    </div>
                </div>

                <!-- 用户信息 -->
                <div class="p-4 border-t border-gray-700">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <img src="https://picsum.photos/seed/user/36/36" alt="User" class="w-9 h-9 rounded-full mr-2">
                            <div>
                                <div class="text-sm font-medium">访客用户</div>
                                <div class="text-xs text-gray-400">在线</div>
                            </div>
                        </div>
                        <button id="settingsBtn" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </aside>

            <!-- 聊天区域 -->
            <section class="flex-1 flex flex-col">
                <!-- 消息显示区域 -->
                <div id="messagesContainer" class="flex-1 overflow-y-auto p-6 space-y-4">
                    <div class="text-center py-8">
                        <i class="fas fa-robot text-4xl text-blue-400 mb-4"></i>
                        <h2 class="text-xl font-semibold mb-2">量子销售经理智能体</h2>
                        <p class="text-gray-400">准备好为您提供专业的量子计算解决方案咨询</p>
                    </div>
                </div>

                <!-- 输入区域 -->
                <div class="border-t border-gray-700 p-4">
                    <div class="max-w-4xl mx-auto">
                        <div class="flex space-x-3">
                            <div class="flex-1 relative">
                                <textarea
                                    id="messageInput"
                                    placeholder="请输入您的问题..."
                                    rows="1"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 pr-12 text-sm resize-none focus:outline-none focus:border-blue-500 transition-colors"
                                ></textarea>
                                <button class="absolute right-3 top-3 text-gray-400 hover:text-white transition-colors">
                                    <i class="fas fa-paperclip"></i>
                                </button>
                            </div>
                            <button
                                id="sendButton"
                                class="deepseek-gradient px-6 py-3 rounded-lg font-medium hover:opacity-90 transition-opacity disabled:opacity-50"
                            >
                                <i class="fas fa-paper-plane mr-2"></i>发送
                            </button>
                        </div>
                        <div class="flex justify-between items-center mt-2 text-xs text-gray-500">
                            <span>内容由AI生成，请仔细甄别</span>
                            <div class="flex space-x-3">
                                <button class="hover:text-white transition-colors">
                                    <i class="fas fa-microphone mr-1"></i>语音输入
                                </button>
                                <button class="hover:text-white transition-colors">
                                    <i class="fas fa-expand mr-1"></i>全屏
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // API基础URL
        const API_BASE = window.location.hostname === 'localhost' ? 'http://localhost:8000' : '';

        // 全局状态
        let currentSessionId = null;
        let isStreaming = false;
        let wsConnection = null;

        // DOM元素
        const elements = {
            messageInput: document.getElementById('messageInput'),
            sendButton: document.getElementById('sendButton'),
            messagesContainer: document.getElementById('messagesContainer'),
            agentName: document.getElementById('agentName'),
            agentDesc: document.getElementById('agentDesc'),
            agentExpertise: document.getElementById('agentExpertise'),
            agentPersonality: document.getElementById('agentPersonality'),
            exportBtn: document.getElementById('exportBtn'),
            settingsBtn: document.getElementById('settingsBtn'),
            historyList: document.getElementById('historyList')
        };

        // 初始化应用
        async function initApp() {
            await loadAgentInfo();
            setupEventListeners();
            connectWebSocket();
        }

        // 加载智能体信息
        async function loadAgentInfo() {
            try {
                const response = await fetch(`${API_BASE}/api/agents/quantum_sales_manager`);
                if (response.ok) {
                    const agentInfo = await response.json();
                    elements.agentName.textContent = agentInfo.name;
                    elements.agentDesc.textContent = agentInfo.description;
                    elements.agentExpertise.textContent = agentInfo.expertise_domains.join(', ');
                    elements.agentPersonality.textContent = agentInfo.personality_tags.join(', ');
                }
            } catch (error) {
                console.error('加载智能体信息失败:', error);
            }
        }

        // 设置事件监听器
        function setupEventListeners() {
            // 发送消息
            elements.sendButton.addEventListener('click', sendMessage);
            elements.messageInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // 自动调整文本域高度
            elements.messageInput.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });

            // 导出对话
            elements.exportBtn.addEventListener('click', exportConversation);

            // 设置按钮
            elements.settingsBtn.addEventListener('click', showSettings);
        }

        // 连接WebSocket
        function connectWebSocket() {
            try {
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const wsUrl = `${protocol}//${window.location.host}/ws/chat`;
                
                wsConnection = new WebSocket(wsUrl);
                
                wsConnection.onopen = () => {
                    console.log('WebSocket连接已建立');
                };
                
                wsConnection.onmessage = (event) => {
                    const data = JSON.parse(event.data);
                    handleWebSocketMessage(data);
                };
                
                wsConnection.onclose = () => {
                    console.log('WebSocket连接已关闭');
                    // 5秒后重连
                    setTimeout(connectWebSocket, 5000);
                };
                
                wsConnection.onerror = (error) => {
                    console.error('WebSocket错误:', error);
                };
                
            } catch (error) {
                console.error('WebSocket连接失败:', error);
            }
        }

        // 处理WebSocket消息
        function handleWebSocketMessage(data) {
            switch (data.type) {
                case 'stream_start':
                    currentSessionId = data.session_id;
                    startStreamingResponse();
                    break;
                case 'chunk':
                    appendStreamChunk(data.content);
                    break;
                case 'stream_end':
                    endStreamingResponse();
                    break;
                case 'error':
                    showError(data.message);
                    endStreamingResponse();
                    break;
            }
        }

        // 发送消息
        async function sendMessage() {
            const message = elements.messageInput.value.trim();
            if (!message || isStreaming) return;

            // 添加用户消息
            addMessage('user', message);
            elements.messageInput.value = '';
            elements.messageInput.style.height = 'auto';

            // 禁用输入
            setInputDisabled(true);

            try {
                // 通过WebSocket发送消息
                if (wsConnection && wsConnection.readyState === WebSocket.OPEN) {
                    wsConnection.send(JSON.stringify({
                        message: message,
                        agent_id: 'quantum_sales_manager',
                        session_id: currentSessionId
                    }));
                } else {
                    // 备用HTTP请求
                    await sendHttpMessage(message);
                }
            } catch (error) {
                console.error('发送消息失败:', error);
                showError('发送消息失败，请检查网络连接');
                setInputDisabled(false);
            }
        }

        // HTTP方式发送消息（备用）
        async function sendHttpMessage(message) {
            try {
                const response = await fetch(`${API_BASE}/api/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: message,
                        agent_id: 'quantum_sales_manager',
                        session_id: currentSessionId,
                        stream: false
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        addMessage('assistant', result.data.response);
                        currentSessionId = result.data.session_id;
                    } else {
                        showError(result.error);
                    }
                } else {
                    showError('服务器响应错误');
                }
            } catch (error) {
                showError('网络请求失败');
            } finally {
                setInputDisabled(false);
            }
        }

        // 开始流式响应
        function startStreamingResponse() {
            isStreaming = true;
            addStreamingIndicator();
        }

        // 添加流式响应块
        function appendStreamChunk(chunk) {
            const streamingElement = document.querySelector('.streaming-message');
            if (streamingElement) {
                streamingElement.innerHTML += chunk;
                scrollToBottom();
            }
        }

        // 结束流式响应
        function endStreamingResponse() {
            isStreaming = false;
            removeStreamingIndicator();
            setInputDisabled(false);
            updateHistory();
        }

        // 添加消息到界面
        function addMessage(role, content) {
            const messageElement = createMessageElement(role, content);
            elements.messagesContainer.appendChild(messageElement);
            scrollToBottom();
        }

        // 创建消息元素
        function createMessageElement(role, content) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex ${role === 'user' ? 'justify-end' : 'justify-start'} animate-fade-in`;
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = `message-bubble max-w-xl px-4 py-3 rounded-2xl ${
                role === 'user'
                    ? 'bg-blue-600 ml-12 rounded-br-none'
                    : 'bg-gray-700 mr-12 rounded-bl-none'
            }`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'text-sm leading-relaxed';
            contentDiv.innerHTML = content.replace(/\n/g, '<br>');
            
            const timeSpan = document.createElement('span');
            timeSpan.className = 'text-xs text-gray-400 block mt-2';
            timeSpan.textContent = new Date().toLocaleTimeString();
            
            bubbleDiv.appendChild(contentDiv);
            bubbleDiv.appendChild(timeSpan);
            messageDiv.appendChild(bubbleDiv);
            
            return messageDiv;
        }

        // 添加流式指示器
        function addStreamingIndicator() {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'flex justify-start animate-fade-in';
            
            const bubbleDiv = document.createElement('div');
            bubbleDiv.className = 'message-bubble max-w-xl px-4 py-3 rounded-2xl bg-gray-700 mr-12 rounded-bl-none streaming-message';
            
            const dotsDiv = document.createElement('div');
            dotsDiv.className = 'streaming-dots flex space-x-1';
            dotsDiv.innerHTML = '<span class="w-2 h-2 bg-blue-400 rounded-full"></span>'.repeat(3);
            
            bubbleDiv.appendChild(dotsDiv);
            messageDiv.appendChild(bubbleDiv);
            elements.messagesContainer.appendChild(messageDiv);
            scrollToBottom();
        }

        // 移除流式指示器
        function removeStreamingIndicator() {
            const streamingElement = document.querySelector('.streaming-message');
            if (streamingElement) {
                streamingElement.classList.remove('streaming-message');
            }
        }

        // 滚动到底部
        function scrollToBottom() {
            elements.messagesContainer.scrollTop = elements.messagesContainer.scrollHeight;
        }

        // 设置输入禁用状态
        function setInputDisabled(disabled) {
            elements.messageInput.disabled = disabled;
            elements.sendButton.disabled = disabled;
            elements.sendButton.textContent = disabled ? '发送中...' : '<i class="fas fa-paper-plane mr-2"></i>发送';
        }

        // 显示错误
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'flex justify-center';
            errorDiv.innerHTML = `
                <div class="bg-red-900 border border-red-700 text-red-200 px-4 py-2 rounded-lg text-sm">
                    <i class="fas fa-exclamation-triangle mr-2"></i>${message}
                </div>
            `;
            elements.messagesContainer.appendChild(errorDiv);
            scrollToBottom();
        }

        // 导出对话
        async function exportConversation() {
            if (!currentSessionId) {
                alert('暂无对话可导出');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/api/conversations/${currentSessionId}/export`);
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        // 创建下载链接
                        const blob = new Blob([result.data.content], { type: 'text/markdown' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = result.data.filename;
                        a.click();
                        URL.revokeObjectURL(url);
                    } else {
                        alert(`导出失败: ${result.error}`);
                    }
                } else {
                    alert('导出请求失败');
                }
            } catch (error) {
                alert('导出过程中发生错误');
            }
        }

        // 显示设置
        function showSettings() {
            alert('设置功能开发中...');
        }

        // 更新历史记录
        function updateHistory() {
            // 这里可以添加历史记录更新逻辑
        }

        // 启动应用
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>

        // 模板配置
        const templates = {
            role_definition: {
                name: "角色定义",
                description: "定义智能体的核心身份和职责边界",
                required: true
            },
            reasoning_framework: {
                name: "推理框架",
                description: "用于销售场景的思考框架",
                required: false
            },
            retrieval_strategy: {
                name: "检索策略",
                description: "指导何时以及如何调用知识工具",
                required: false
            },
            safety_policy: {
                name: "安全策略",
                description: "确保对话安全合规",
                required: false
            },
            process_guide: {
                name: "流程指导",
                description: "指导销售流程",
                required: false
            }
        };

        // 主应用组件
        function App() {
            const [messages, setMessages] = useState([
                {
                    id: 1,
                    role: "assistant",
                    content: "您好！我是量子销售经理，专门负责量子计算解决方案的销售工作。我可以帮您解答关于量子计算的优势、应用场景以及如何实施量子解决方案的问题。",
                    timestamp: new Date().toLocaleTimeString()
                }
            ]);
            const [inputMessage, setInputMessage] = useState("");
            const [isStreaming, setIsStreaming] = useState(false);
            const [showConfig, setShowConfig] = useState(false);
            const messagesEndRef = useRef(null);

            // 滚动到底部
            useEffect(() => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [messages]);

            // 处理发送消息
            const handleSendMessage = async () => {
                if (inputMessage.trim() === "") return;
                
                // 添加用户消息
                const userMessage = {\n                    id: messages.length + 1,
                    role: "user",
                    content: inputMessage,
                    timestamp: new Date().toLocaleTimeString()
                };
                setMessages([...messages, userMessage]);
                setInputMessage("");
                setIsStreaming(true);

                // 模拟AI响应
                setTimeout(() => {
                    const aiResponse = {
                        id: messages.length + 2,
                        role: "assistant",
                        content: "感谢您的提问！关于量子计算的优势和应用场景，我可以为您提供以下信息：

1. **量子计算的核心优势**：
   - 超级并行计算能力
   - 解决传统计算机难以处理的复杂问题
   - 在特定领域（如密码学、材料科学）具有指数级加速

2. **主要应用场景**：
   - 量子化学模拟
   - 优化问题求解
   - 机器学习加速
   - 密码学与安全

您想了解哪个方面的更多细节吗？",
                        timestamp: new Date().toLocaleTimeString()
                    };
                    setMessages([...messages, userMessage, aiResponse]);
                    setIsStreaming(false);
                }, 1000);\n            };

            return (
                <div className="flex flex-col h-screen">
                    {/* 顶部导航栏 */}
                    <header className="bg-gray-800 p-4 flex justify-between items-center border-b border-gray-700">
                        <div className="flex items-center">
                            <div className="flex items-center mr-4">
                                <i className="fas fa-robot text-blue-400 text-xl mr-2"></i>\n                                <span className="text-lg font-semibold">量子销售经理</span>
                            </div>
                            <div className="flex space-x-2">
                                <button className="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded-md text-sm flex items-center">
                                    <i className="fas fa-user-circle mr-1"></i>
                                    配置
                                </button>\n                                <button className="bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded-md text-sm flex items-center">
                                    <i className="fas fa-download mr-1"></i>\n                                    导出
                                </button>\n                            </div>
                        </div>
                        <div className="flex items-center">
                            <span className="text-sm text-gray-400 mr-2">用户请求硬编码知识生成</span>
                            <i className="fas fa-chevron-down text-gray-400"></i>\n                        </div>
                    </header>\n
                    {/* 主聊天区域 */}\n                    <div className="flex-1 flex">
                        {/* 左侧边栏 */}\n                        <div className="w-64 bg-gray-800 border-r border-gray-700 flex flex-col">
                            {/* 角色卡 */}
                            <div className="p-4 border-b border-gray-700">
                                <div className="flex items-center p-3 bg-gray-700 rounded-lg">
                                    <img src={agentConfig.avatar} alt="Agent Avatar" className="w-10 h-10 rounded-full mr-3" />
                                    <div>
                                        <h3 className="font-medium">{agentConfig.name}</h3>\n                                        <p className="text-xs text-gray-400">{agentConfig.description}</p>
                                    </div>
                                </div>
                            </div>

                            {/* 工具选择 */}\n                            <div className="p-4 border-b border-gray-700">
                                <h3 className="text-sm font-medium mb-3">工具选择</h3>
                                <div className="space-y-2">
                                    <div className="flex items-center p-2 bg-gray-700 rounded-md">
                                        <i className="fas fa-chart-line text-blue-400 mr-2"></i>
                                        <span className="text-sm">数据分析</span>
                                    </div>
                                    <div className="flex items-center p-2 hover:bg-gray-700 rounded-md cursor-pointer">
                                        <i className="fas fa-file-alt text-green-400 mr-2"></i>
                                        <span className="text-sm">文档生成</span>
                                    </div>
                                    <div className="flex items-center p-2 hover:bg-gray-700 rounded-md cursor-pointer">
                                        <i className="fas fa-calculator text-purple-400 mr-2"></i>\n                                        <span className="text-sm">计算器</span>
                                    </div>
                                </div>
                            </div>

                            {/* 历史记录 */}\n                            <div className="flex-1 overflow-y-auto p-4">
                                <div className="space-y-2">
                                    <div className="p-3 bg-gray-700 rounded-md">
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="text-sm font-medium">历史对话</span>
                                            <span className="text-xs text-gray-400">今天</span>
                                        </div>
                                        <div className="text-xs text-gray-400">\n                                            <div className="mb-1">用户请求硬编码知识生成</div>
                                            <div>15:30</div>
                                        </div>
                                    </div>
                                    <div className="p-3 bg-gray-700 rounded-md">
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="text-sm font-medium">昨天</span>
                                            <span className="text-xs text-gray-400">16:45</span>
                                        </div>
                                        <div className="text-xs text-gray-400">\n                                            <div className="mb-1">量子计算优势咨询</div>
                                            <div>16:45</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            {/* 用户头像和配置按钮 */}\n                            <div className="p-4 border-t border-gray-700 flex justify-between items-center">
                                <div className="flex items-center">
                                    <img src="https://picsum.photos/seed/user/40/40.jpg" alt="User Avatar" className="w-8 h-8 rounded-full mr-2" />
                                    <span className="text-sm">用户</span>
                                </div>
                                <button 
                                    onClick={() => setShowConfig(!showConfig)}
                                    className="text-gray-400 hover:text-white"
                                >
                                    <i className="fas fa-cog"></i>
                                </button>\n                            </div>
                        </div>

                        {/* 右侧聊天区域 */}
                        <div className="flex-1 flex flex-col">\n                            {/* 聊天消息区域 */}
                            <div className="flex-1 p-4 overflow-y-auto space-y-4">
                                {messages.map(message => (
                                    <div 
                                        key={message.id} 
                                        className={`flex ${message.role === \'user\' ? \'justify-end\' : \'justify-start\'}`}\n                                    >
                                        <div className={`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${message.role === \'user\' ? \'bg-gray-700 ml-auto\' : \'bg-gray-700 mr-auto\'}`}>
                                            <p className="text-sm">{message.content}</p>
                                            <span className="text-xs text-gray-400 mt-1 block">{message.timestamp}</span>
                                        </div>
                                    </div>
                                ))}
                                {isStreaming && (
                                    <div className="flex justify-start">
                                        <div className="max-w-xs lg:max-w-md px-4 py-2 rounded-lg bg-gray-700 mr-auto">
                                            <div className="flex space-x-1">
                                                <div className="w-2 h-2 bg-blue-500 rounded-full animate-bounce"></div>
                                                <div className="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style={{animationDelay: \'0.2s\'}}></div>
                                                <div className="w-2 h-2 bg-blue-500 rounded-full animate-bounce" style={{animationDelay: \'0.4s\'}}></div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>

                            {/* 输入区域 */}\n                            <div className="p-4 border-t border-gray-700">
                                <div className="flex space-x-2">
                                    <button className="p-2 text-gray-400 hover:text-white">
                                        <i className="fas fa-paperclip"></i>\n                                    </button>\n                                    <input
                                        type="text"
                                        value={inputMessage}
                                        onChange={(e) => setInputMessage(e.target.value)}
                                        onKeyPress={(e) => e.key === \'Enter\' && handleSendMessage()}
                                        placeholder="输入您的问题..."
                                        className="flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-sm focus:outline-none focus:border-blue-500"\n                                    />
                                    <button 
                                        onClick={handleSendMessage}
                                        className="bg-blue-600 hover:bg-blue-700 p-2 rounded-lg"
                                    >
                                        <i className="fas fa-paper-plane"></i>
                                    </button>\n                                </div>
                                <div className="mt-2 flex justify-between text-xs text-gray-500">\n                                    <span>内容由AI生成，请仔细甄别</span>
                                    <div className="flex space-x-2">
                                        <button className="flex items-center text-gray-400 hover:text-white">
                                            <i className="fas fa-microphone mr-1"></i>
                                            语音输入
                                        </button>\n                                        <button className="flex items-center text-gray-400 hover:text-white">
                                            <i className="fas fa-expand-arrows-alt mr-1"></i>\n                                            全屏
                                        </button>\n                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById(\'root\'));
    </script>
</body>\n</html>